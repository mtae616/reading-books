# 데이터 모델과 질의 언어
- 문제를 어떻게 생각해야 하는지
- 데이터 모델을 어떻게 표현해야 하는지
  - 성능
  - 표현 방식
  - 관계형 모델 vs 문서 모델 vs 그래프 기반 데이터 모델

## 관계형 모델과 문서 모델
- 관계형 모델
  - 관계형 모델을 기반으로 한 sql
  - rdb
  - 트랜잭션, 일괄 처리

### NoSQL 의 탄생
- NoSQL 채택 이유
  - 높은 쓰기 처리량, 뛰어난 확장성
  - 무료 오픈소스
  - RDB 에서 지원하지 않는 특수 질의 동작
  - 더욱 동적이고 표현력이 풍부한 데이터 모델
- RDB + ... NoSQL -> polyglot

### 객체 관계형 불일치
- 임피던스 불일치
  - 객체 지향 프로그래밍과 DB 사이의 데이터 표현하는 방식의 차이
- one to many 를 나타내는 방법
  - fk
  - json, xml 등 데이터에 대한 지원으로 컬럼에 추가

### 다대일과 다대다 관계
- RDB 가 훨씬 유리
  - NoSQL, 문서 모델은 다대다, 다대일을 애플리케이션에서 흉내내야 한다.
  - 혹은 JSON 처럼 컬럼 내에 데이터를 저장한

## 어떤 데이터 모델이 애플리케이션 코드를 더 간단하게 할까?
- 문서와 비슷한 구조 (일대다 관계 트리로 보통 한 번에 전체 트리를 적재)
  - 문서 모델

## 문서 모델에서의 스키마 유연성
- JSON 은 스키마를 강요하지 않는다.
- 스키마 리스
  - 암묵적인 스키마가 있지만 데이터베이스는 이를 강요하지 않는다.
  - 쓰기 스키마
    - 관계형 데이터베이스의 전통적인 접근 방식으로 스키마는 명시적이고 데이터 베이스는 쓰여진 모든 데이터가 스키마를 따르고 있음을 보장
  - 읽기 스키마
    - 데이터 구조는 암묵적이고 데이터를 읽을 때만 해석된다
    - 문서 모델은 여기에 포함됨

## 데이터를 위한 질의 언어
- 선언형 질의
  - SQL, CSS
  - 목표를 달성하기 위한 방법이 아니라 알고자하는 데이터의 패턴
  - 결과가 충족해야 하는 조건과 데이터를 어떻게 변환할 것인지
- 명령형 코드
  - 프로그래밍 언어

## 그래프형 데이터 모델
- RDB 도 가능하지만 연결이 더 복잡해지면 그래프로 하는 편이 자연스럽다
- vertex - edge - arc
  - SNS Follow
  - 도로, 철도
- 그래프를 구조화, 질의하는 방법
  - 속성 그래프 모델
  - 트리플 저장소 모델
  - 선언형 질의어 세가지

### 속성 그래프
- 노드 요소
  - 고유한 식별자
  - 유출 간선 집합
  - 유입 간선 집합
  - 속성 컬렉션
- 간선 요소
  - 고유한 식별자
  - 간선이 시작하는 정점
  - 간선이 끝나는 정점
  - 두 정점 간 관계 유형을 설명하는 레이블
  - 속성 컬렉션
- 책에서는 json 으로 만들어서 head, tail 을 각각 이어주는 방식으로 설명

### SQL 그래프 질의
- rdb 에서도 사용할 수 있지만 약간 어려움
- recursive common table expression (With recursive) 를 사용해서 표

### 트리플 저장소와 스파클
- 속성 그래프 모델과 거의 동일

### 정리
- 관계형 데이터 모델
- NoSQL
  - 문서 데이터베이스
    - 스키마를 강제하지 않아 변경이 쉬움
  - 그래프 데이터베이스