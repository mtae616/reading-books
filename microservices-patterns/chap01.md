# 모놀리식 지옥에서 벗어나라

## 1.1.2 모놀리식 아케텍처의 장점
- 개발이 간단하다
- 애플리케이션을 쉽게 변경할 수 있다.
- 테스트하기 쉽다.
- 배포하기 쉽다.
- 확장하기 쉽다

## 1.1.3 모놀리식 지옥의 실상
- 코드베이스와 관리 오버헤드 증가
- 개발이 더디다
  - 애플리케이션이 너무 켜저서 실행 속도, 빌드 시간, 구동 시간이 너무 큼
- 커밋부터 배포에 이르는 길고 험난한 여정
  - 여러 개발자가 같은 코드베이스에 소스 커밋을 하나 보니 릴리스 할 수 없을 때도 있음
  - 기능 브랜치로 나눠도 머지하기가 힘듬
- 확장하기 어려움
  - 리소스 요건이 서로 맞지 않음
  - e.g. 어떤 서버에서는 메모리를 많이 사용하지만 어떤 서버에서는 CPU 를 많이 사용함
- 모놀리스는 확실하게 전달하기 어렵다
  - 어떤 모듈에 버그 하나만 있어도 전체 애플리케이션 셧다운으로 발생
- 갈수록 한물간 기술 스택에 발목이 붙잡히다
  - 특성상 새로운 프레임워크, 프로그래밍을 받아들이기 어려움

## 1.4.1 확장 큐브와 마이크로 서비스
- x축 확장 : 다중 인스턴스에 고루 요청 분산
  - Load balancing
- Z축 확장 : 요청 속설 병 라우팅
  - sharding
- Y축 확장 : 기능에 따라 애플리케이션을 서비스로 분해
  - reverse proxy
    -주문, 고객, 리뷰 서버를 각각 만듬

## 1.4.2 마이크로 서비스는 모듈성을 갖고 있다.

## 1.4.3 서비스마다 DB 가 따로 있다.
- 느슨하게 결합되어 있고 오직 API 를 통해 통신
- 다른 서비스가 DB 락을 획득해 내 서비스를 블로킹 하는 일이 없음

## 1.5 마이크로서비스 아키텍처의 장단점

## 1.5.1 마이크로서비스 아키텍처의 장점
- 크로 복잡한 애플리케이션을 지속적으로 전달/배포할 수 있다.
  - Test, CI/CD
- 서비스 규모가 작아 관리하기 쉽다.
  - 코드베이스가 작아 이해하기 쉬움
- 서비스를 독립적으로 배포/확장할 수 있다.
- 마이크로서비스 아키텍처 덕분에 팀이 자율적으로 움직인다.
- 결함 격리가 잘된다.
- 새로운 기술을 실험하고 도입하기 쉽다.

## 1.5.2 마이크로서비스 아키텍처의 단점
- 딱 맞는 서비스를 찾기가 쉽지 않다.
  - 여러 서비스로 분해하는 기준점을 찾기 어려움
- 분산 시스템은 너무 복잡해서 개발, 테스트, 배포가 어렵다.
  - IPC
- 여러 서비스에 걸친 기능을 배포할 때에는 잘 조정해야 한다.
- 마이크로서비스 아키텍처 도입 시점을 결정하기가 어렵다.
  - 언제 MSA 를 도입하게 될지

## 1.6.2 패턴 및 패턴 언어
- 상용 패턴의 구조
  - 강제 조항
    - 문제 해결을 위해 반드시 처리해야 할 이슈
    - 주어진 맥락에서 문제를 해결하고자 할 때 반드시 처리해야 할 강제 조항
  - 결과 맥락
    - 패턴 적용 결과
    - 장점
    - 단점
    - 이슈
  - 연관 패턴
    - 다섯 가지 관계 유형
    - 선행자
      - 선행 패턴
    - 후행자
      - 이 패턴으로 야기된 이슈를 해결하는 패턴
    - 대안
      - 이 패턴의 대체 솔루션을 제공하는 패턴
    - 일반화
      - 문제를 해결하는 일반적인 솔루션에 해당하는 패턴
    - 세분화
      - 특정 패턴을 더 세부적으로 나타낸 형태

## 1.6.3 마이크로서비스 아키텍처 패턴 언어 개요
- 인프라 패턴
  - 주로 개발 영영 밖의 인프라 문제
- 애플리케이션 인프라
  - 개발에도 영향을 미치는 인프라 문제를 해결
- 애플리케이션 패턴
  - 개발자가 맞닥뜨리는 문제를 해결
- 애플리케이션을 여러 서비스로 분해하는 패턴
  - 통신 패턴
    - 통신 스타일
      - IPC
    - 디스커버리
      - 서비스 클라이언트는 서비스 인스턴스의 IP 주소를 어떻게 가져오는가
    - 신뢰성
      - 서비스 불능 시 서비스 간 통신의 신뢰성은 어떻게 보장되는가?
    - 트랜잭셔널 메시징
      - 비즈니스 데이터를 업데이트하는 DB 트랜잭션에 메시지를 송신하고 이벤트를 발행하는 행위를 어떻게 통합하는가
    - 외부 API
      - 애플리케이션 클라이언트는 서비스와 어떻게 통신하는가
- 트랜잭션 관리를 위한 데이터 일관성 패턴
  - saga pattern
  - data query pattern
    - API 조합 패턴은 하나 이상의 서비스를 호출해서 그 결과를 조합
    - CQRS 는 하나 이상의 데이터 레플리카를 유지해서 쉽게 쿼리
  - 서비스 배포 패턴
  - 관측성 패턴: 애플리케이션 동작 파악
    - 헬스 체크
    - 로그 수집
    - 분산 추적
    - 예외 추적
    - 애플리케이션 지표
    - 감사 로깅
  - 서비스 테스트 자동화 패턴
    - 컨슈머 주도 계약 테스트
    - 컨슈머 쪽 계약 테스트
    - 서비스 컴포넌트 테스트
  - 횡단 관심사 처리 패턴
  - 보안 패턴
    - API 인증, 인가

## 요약
- 모놀리식 -> 애플리케이션을 하나의 배포 단위로 구성
- MSA -> 독립적으로 배포 가능, 자체 DB 를 보유한 서비스들로 분해
- MSA -> 자율적인 소규모 팀들이 작업을 병행하여 개발 속도 빠름1