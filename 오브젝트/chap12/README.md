# 다형성
- 상속의 목적은 코드 재사용이 아니다.
  - 상속은 타입 계층을 구조화하기 위해 사용돼야 한다.
  - 서브타입의 구현

## 다형성
- 많은 형태를 가질 수 있는 능력
- 유니버셜 다형성, Universal
  - 매개변수 다형성, Parametric
    - generic <T>
  - 포함 다형성, Inclusion
    - subtype -> 상속을 이용한다
- 임시 다형성, Ad Hoc
  - 오버로딩 다형성, Overloading
    - 하나의 클래스 안에 동일한 이름의 메서드가 존재하는 경우
  - 강제 다형성, Coercion
    - 언어가 지원하는 자동적인 타입 변환이나 사용자가 직접 구현한 타입 변환을 이용해 동일한 연산자를 다양한 타입에 사용할 수 있는 방식
    - e.g. java 에서 integer 에 + "" 하면 string 되는거

## 상속의 양면성
- 객체지향 패러다임의 근간을 이루는 아이디어는 데이터와 행동을 객체라고 불리는 하나의 실행 단위 안으로 통합하는 것
- 상속 역시 데이터(필드)와 행동(메서드)이라는 두 가지 관점을 고려해야 한다.
- 데이터 관점의 상속
  - 자식 클래스의 인스턴스 안에 부모 클래스의 인스턴스를 포함하는 것
- 행동 관점의 상속
  - 부모 클래스가 정의한 일부 메서드를 자식 클래스의 메서드로 포함시키는 것

## 업캐스팅과 동적 바인딩
- 같은 메시지, 다른 메서드
- 업캐스팅
  - 부모 클래스 타입으로 ㅅ너언된 변수에 자식 클래스의 인스턴스를 할당하는 것
- 동적 바인딩
  - 선언된 변수의 타입이 아니라 메시지를 수신하는 객체의 타입에 따라 실행되는 메서드가 다른 것

## 동적 메서드 탐색과 다형성
- 객체지향 시스템의 실행 메서드 선택 규칙
  - 메시지를 수신한 객체는 먼저 자신을 생성한 클래스에 적합한 메서드가 존재하는지 검사, 있다면 실행
  - 메서드를 찾지 못했다면 부모 메서드 탐색을 계속하며 상위로 올라간다
  - 상속 계층의 최상위 클래스에 메서드를 발견하지 못한 경우 예외를 발생시키며 탐색 중단
- self 참조 (자바에서는 this)
  - 객체가 메시지를 수신하면 컴파일러는 self 참조라는 임시 변수를 자동으로 생성한 후 수신한 객체를 가리키도록 설정
  - 동적 메서드 탐색은 self 가 가리키는 객체의 클래스에서 시작해서 상속 계층의 역방향으로 이뤄지며 메서드 탐색이 종료되는 순간 self 참조는 자동으로 소멸된다.
- 자동적인 메시지 위임
  - 상속 계층 안의 클래스는 메시지를 처리할 방법을 알지 못할 경우 메시지에 대한 처리를 부모 클래스에게 위임한다.
  - 적절한 메서드를 찾을 때까지 상속 계층을 따라 부모 클래스로 처리가 위임된다.
- 동적인 문맥
  - 수신한 객체가 무엇이냐에 따라 메서드 탐색을 위한 문맥이 동적으로 바뀐다.
    - 동적인 문맥을 결정하는 것은 메시지를 수신한 객체를 가리키는 self 참조
  - 동일한 코드라고 하더라도 self 참조가 가리키는 객체가 무엇인지에 따라 메서드 탐색을 위한 상속 계층의 범위가 동적으로 변한다.
  - self 참조가 가리키는 객체의 타입을 변경함으로써 객체가 실행도리 문맥을 동적으로 바꿀 수 있다.
  - 같은 클래스 내의 함수를 호출하는 것은 현재 객체에게 메시지를 전송하는 것이다.
    - 현재 객체는 self 참조가 가리키는 개체이다
    - self 참조가 가리키는 자기 자신에게 메시지를 전송하는 것을 self 전송이라고 한다.
      - 각주 : 어셈블리어 수준의 해석이 아닌가 생각됨, 혹은 self 자체를 클라이언트로 본다...?
- 이해할 수 없는 메시지
  - 정적 타입 언어
    - checked error
  - 동적 타입 언어
    - unchecked error
- self 대 super
  - super 참조를 이용해 메시지를 전송한다.
    - 부모 클래스의 메서드가 아니라 더 상위에 위치한 조상 클래스의 메서드일 수도 있다.
  - super 참조의 정확한 의도는 '지금 이 클래스의 부모 클래스에서부터 메서드 탐색을 시작해라' 다

## 상속 대 위임
- 동일한 타입의 객체 참조에게 동일한 메시지를 전송하더라도 self 참조가 가리키는 객체의 클래스가 무엇이냐에 따라 메서드 탐색을 위한 문맥이 달라진다.
  - 자식 클래스에서 부모 클래스로 self 참조를 전달하는 메커니즘을 상속으로 바라보는 것이다
- 위임과 self 참조 
  - 자신이 수신한 메시지를 다른 객체에게 동일하게 전달해서 처리를 요청하는 것
  - 자신이 정의하지 않거나 처리할 수 없는 속성 또는 메서드의 탐색 과정을 다른 객체로 이동시키기 위해 사용
  - 위임은 항상 현재의 실행 문맥을 가리키는 self 참조를 인자로 전달한다.
- 상속 관계로 연결된 클래스 사이에는 자동적인 메시지 위임이 일어난다
  - 상속은 동적으로 메서드를 탐색하기 위해 현재의 실행 문맥을 가지고 있는 self 참조를 전달한다.
  - 그리고 이 객체들 사이에서 메시지를 전달하는 과정은 자동으로 이뤄진다.
  - 따라서 자동적인 메시지 위임이라고 부른다.
